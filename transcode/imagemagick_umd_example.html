<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ImageMagick UMD 示例</title>
    <!-- <script src="./imagemagick/index.umd.cjs"></script> -->
    <!-- <script src="./ffmpeg/ffmpeg.js"></script> -->
    <script src="./ffmpeg11/ffmpeg.min.js"></script>
  </head>
  <body>
    <h1>ImageMagick UMD 导入示例</h1>

    <input type="file" id="fileInput" accept="image/*" />
    <div id="output"></div>
    <!-- 方法1: 直接引用本地文件 -->

    <!-- 方法2: 如果你使用的是 CDN 版本，可以这样引用 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/your-imagemagick-package/index.umd.js"></script> -->

    <script>
      

      // UMD 格式的库通常会在全局作用域中创建一个变量
      // 具体的变量名取决于库的配置，常见的可能是：
      // - ImageMagick
      // - imagemagick
      // - IM
      // - Magick

      // 检查库是否正确加载
      console.log('Available global objects:', Object.keys(window));

      // 尝试不同的可能的全局变量名
      // 'magick-wasm', 'FFmpegWASM',
      // const possibleNames = ['FFmpegUtil',];

      // let ImageMagickLib = null;

      // for (const name of possibleNames) {
      //     if (window[name]) {
      //         console.log(`Found ImageMagick library at: window.${name}`);
      //         ImageMagickLib = window[name];
      //         break;
      //     }
      // }

      // if (!ImageMagickLib) {
      //     console.error('ImageMagick library not found. Check the script path and global variable name.');
      //     document.getElementById('output').innerHTML = '<p style="color: red;">ImageMagick 库未找到，请检查路径和全局变量名</p>';
      // } else {
      //     console.log('ImageMagick library loaded successfully:', ImageMagickLib);

      //     // 示例：处理文件上传
      //     document.getElementById('fileInput').addEventListener('change', async function(event) {
      //         const file = event.target.files[0];
      //         if (!file) return;

      //         try {
      //             // 这里的具体API调用取决于你使用的ImageMagick库的接口
      //             // 以下是一般性的示例代码

      //             const arrayBuffer = await file.arrayBuffer();
      //             const uint8Array = new Uint8Array(arrayBuffer);

      //             // 示例处理（具体API需要根据库的文档调整）
      //             // const result = await ImageMagickLib.process(uint8Array);

      //             document.getElementById('output').innerHTML = `
      //                 <p>文件已选择: ${file.name}</p>
      //                 <p>文件大小: ${file.size} bytes</p>
      //                 <p>ImageMagick 库已加载，可以开始处理图像</p>
      //             `;

      //         } catch (error) {
      //             console.error('处理图像时出错:', error);
      //             document.getElementById('output').innerHTML = `<p style="color: red;">处理图像时出错: ${error.message}</p>`;
      //         }
      //     });
      // }

      // 如果库需要初始化，通常在这里进行
      // 例如：
      // ImageMagickLib.initialize?.();
    </script>
  </body>
</html>
